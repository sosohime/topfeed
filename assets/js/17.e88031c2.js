(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{171:function(t,a,s){"use strict";s.r(a);var n=s(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"扩展对象"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#扩展对象","aria-hidden":"true"}},[t._v("#")]),t._v(" 扩展对象")]),t._v(" "),s("p",[t._v("Topfeed 对 Koa 的原生对象进行了一些扩展")]),t._v(" "),s("h3",{attrs:{id:"application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#application","aria-hidden":"true"}},[t._v("#")]),t._v(" Application")]),t._v(" "),s("p",[s("code",[t._v("Application")]),t._v(" 是全局应用对象，在一个应用中，只会实例化一个，它继承自 "),s("code",[t._v("Koa.Application")]),t._v("，在它上面我们可以挂载一些全局的方法和对象。我们可以轻松的在插件或者应用中扩展 "),s("code",[t._v("Application")]),t._v(" 对象。")]),t._v(" "),s("h4",{attrs:{id:"框架扩展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#框架扩展","aria-hidden":"true"}},[t._v("#")]),t._v(" 框架扩展")]),t._v(" "),s("p",[t._v("框架会将一些属性自动挂载到 Context 实例上以便应用使用。")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("config")]),t._v(": 全局配置")]),t._v(" "),s("li",[s("code",[t._v("root")]),t._v(": server 项目根目录")])]),t._v(" "),s("h4",{attrs:{id:"业务扩展"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#业务扩展","aria-hidden":"true"}},[t._v("#")]),t._v(" 业务扩展")]),t._v(" "),s("p",[t._v("为了控制业务的扩展，收敛所有的扩展逻辑，用户在扩展 Application 时需要在 typings 里声明 Application 的扩展，\n否则 ts 检查会报错。\n扩展方式如下")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{attrs:{class:"token constant"}},[t._v("TODO")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#context","aria-hidden":"true"}},[t._v("#")]),t._v(" Context")]),t._v(" "),s("p",[t._v("Context 是一个请求级别的对象，继承自 Koa.Context。在每一次用户收到请求时，框架会实例化一个 Context 对象，\n这个对象封装了这次用户请求的信息，并提供了许多便捷的方法来获取请求参数或设置响应信息。框架会将一些属性自动挂载\n到 Context 实例上以方便应用使用。")]),t._v(" "),s("h4",{attrs:{id:"框架扩展-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#框架扩展-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 框架扩展")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("locale")]),t._v(": 用户语言和地区信息，格式为"),s("code",[t._v("zh-cn")]),t._v(","),s("code",[t._v("en-us")]),t._v(","),s("code",[t._v("en")]),t._v("之类")]),t._v(" "),s("li",[s("code",[t._v("messages")]),t._v(": 用户语言对应的文案格式为 "),s("code",[t._v('{"sign": "登录" }')])]),t._v(" "),s("li",[s("code",[t._v("service")]),t._v(": service 自动挂载")]),t._v(" "),s("li",[s("code",[t._v("render")]),t._v(": 模板渲染")])]),t._v(" "),s("h4",{attrs:{id:"业务扩展-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#业务扩展-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 业务扩展")]),t._v(" "),s("p",[t._v("为了控制业务的扩展，收敛所有的扩展逻辑，用户在扩展 Application 时需要在 typings 里声明 Application 的扩展，\n否则 ts 检查会报错。业务扩展定义需要添加注释。")]),t._v(" "),s("div",{staticClass:"language-ts extra-class"},[s("pre",{pre:!0,attrs:{class:"language-ts"}},[s("code",[s("span",{attrs:{class:"token comment"}},[t._v("// typings/modules.d.ts")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("declare")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("module")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"@topfeed/topfeed/types"')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("Context")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tuserAgent"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token builtin"}},[t._v("string")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{attrs:{class:"token comment"}},[t._v("// 客户端ua信息")]),t._v("\n\t\tlanguage"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token builtin"}},[t._v("string")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{attrs:{class:"token comment"}},[t._v("// 用户语言")]),t._v("\n\t\tregion"),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token builtin"}},[t._v("string")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{attrs:{class:"token comment"}},[t._v("// 用户地区")]),t._v("\n\t"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}],!1,null,null,null);e.options.__file="objects.md";a.default=e.exports}}]);